#!/bin/sh

set -e

#PKGOS-INCLUDE#

PROJECT_NAME=zaqar
PROJECT_CONF=/etc/${PROJECT_NAME}/${PROJECT_NAME}.conf

if [ "$1" = "configure" ] || [ "$1" = "reconfigure" ] ; then
	. /usr/share/debconf/confmodule
	. /usr/share/dbconfig-common/dpkg/postinst

	pkgos_var_user_group ${PROJECT_NAME}

	pkgos_write_new_conf ${PROJECT_NAME} ${PROJECT_NAME}.conf
	pkgos_write_new_conf ${PROJECT_NAME} policy.json
	pkgos_write_new_conf ${PROJECT_NAME} zaqar-benchmark.conf
	pkgos_write_new_conf ${PROJECT_NAME} logging.conf
	pkgos_write_admin_creds /etc/zaqar/zaqar.conf keystone_authtoken zaqar
	#db_get zaqar/configure_db
	#if [ "$RET" = "true" ]; then
	#	zaqar-dbsync || true
	#fi
fi

#DEBHELPER#

exit 0
